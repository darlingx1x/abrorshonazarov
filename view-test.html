<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест кнопок переключения режимов</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body { padding: 20px; font-family: Arial, sans-serif; }
        .test-info { 
            background: #f0f0f0; 
            padding: 15px; 
            margin-bottom: 20px; 
            border-radius: 5px;
        }
        .debug-info {
            background: #e8f4f8;
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h1>Тест кнопок переключения режимов просмотра</h1>
        <p>Откройте консоль браузера (F12) для просмотра отладочной информации.</p>
        <p>Нажимайте на кнопки ниже и проверяйте, меняется ли отображение панелей.</p>
    </div>

    <!-- View mode controls (copied from main app) -->
    <div class="view-controls" role="tablist" aria-label="Режимы просмотра">
        <button class="view-btn active" data-view="split" type="button" role="tab" 
                aria-selected="true" aria-controls="editor-panel preview-panel" 
                aria-label="Разделенный вид">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="12" y1="3" x2="12" y2="21"></line>
            </svg>
            <span class="view-label">Разделенный</span>
        </button>
        <button class="view-btn" data-view="editor" type="button" role="tab" 
                aria-selected="false" aria-controls="editor-panel" 
                aria-label="Только редактор">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
            <span class="view-label">Редактор</span>
        </button>
        <button class="view-btn" data-view="preview" type="button" role="tab" 
                aria-selected="false" aria-controls="preview-panel" 
                aria-label="Только превью">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            <span class="view-label">Превью</span>
        </button>
    </div>

    <div class="debug-info" id="debug-info">
        Текущий режим: <span id="current-mode">split</span><br>
        CSS классы контейнера: <span id="container-classes">-</span>
    </div>

    <!-- Main content area (simplified) -->
    <div class="editor-container view-split" id="test-container">
        <!-- Editor panel -->
        <div id="editor-panel" class="editor-panel">
            <div class="editor-header">
                <h2 class="panel-title">Редактор</h2>
            </div>
            <textarea class="editor-textarea" placeholder="Тестовый редактор..."></textarea>
        </div>

        <!-- Preview panel -->
        <div id="preview-panel" class="preview-panel">
            <div class="preview-header">
                <h2 class="panel-title">Предпросмотр</h2>
            </div>
            <div class="preview-content">
                <p>Тестовый предпросмотр</p>
            </div>
        </div>
    </div>

    <script>
        // Simple test script
        document.addEventListener('DOMContentLoaded', () => {
            console.log('View test page loaded');
            
            const container = document.getElementById('test-container');
            const debugInfo = document.getElementById('debug-info');
            const currentModeSpan = document.getElementById('current-mode');
            const containerClassesSpan = document.getElementById('container-classes');
            
            function updateDebugInfo() {
                currentModeSpan.textContent = getCurrentMode();
                containerClassesSpan.textContent = container.className;
            }
            
            function getCurrentMode() {
                if (container.classList.contains('view-split')) return 'split';
                if (container.classList.contains('view-editor')) return 'editor';
                if (container.classList.contains('view-preview')) return 'preview';
                return 'unknown';
            }
            
            function setViewMode(mode) {
                console.log('Test setViewMode called with:', mode);
                
                // Remove existing classes
                container.classList.remove('view-split', 'view-editor', 'view-preview');
                
                // Add new class
                container.classList.add(`view-${mode}`);
                
                // Update buttons
                document.querySelectorAll('.view-btn').forEach(btn => {
                    const btnMode = btn.dataset.view;
                    const isActive = btnMode === mode;
                    btn.classList.toggle('active', isActive);
                    btn.setAttribute('aria-selected', isActive.toString());
                });
                
                updateDebugInfo();
                console.log('View mode changed to:', mode);
            }
            
            // Add click handlers
            document.querySelectorAll('.view-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const mode = e.currentTarget.dataset.view;
                    console.log('Button clicked:', mode);
                    setViewMode(mode);
                });
            });
            
            updateDebugInfo();
            console.log('Test handlers attached');
        });
    </script>
</body>
</html>